---
layout: post
title: Linux. Пользователи и группы
permalink: linux-users-groups
tags: linux unix
comments: true
subtitle: Управление пользователями в Linux
summary:  Управление пользователями в Linux
is_navigate: true
published: false
---

## !!!Придумать название блока

Linux является многозадачной многопользовательской операционной системой. Это значит что одновременно в
системе могут работать сразу несколько пользователей, каждый из которых может запустить несколько приложений.

Любой объект в linux имеет своего владельца. 
Доступ к этим объектам осуществляется на основании [дискреционной модели](http://www.dataved.ru/2014/02/controlled-access-models.html)

Пользователи и группы хранятся в файлах данных в каталоге `/etc` :
~~~bash
#!/usr/bin/env bash
ls -l /etc/passwd /etc/shadow /etc/group /etc/gshadow
-rw-r--r-- 1 root root   963 Jan  2 23:21 /etc/passwd
-rw-r----- 1 root shadow 527 Jan  2 23:21 /etc/shadow
-rw-r--r-- 1 root root   459 Jan  2 23:21 /etc/group
-rw-r----- 1 root shadow 383 Jan  2 23:21 /etc/gshadow
~~~

Исторически эти файлы содержат простой текст с разделителями в виде двоеточий ` : `.

## Фаил паролей /etc/passwd

Фаил `/etc/passwd` содержит учетные записи пользователей.
Фаил доступен для чтения всем пользователям, но для измнения доступен суперпользователю.

>> По стандарту POSIX.1 фаил называют базой данных пользователей

Пример четырех строк из этого файла, каждая из которых состоит из 7 полей, эти поля так же содержатся в структуре `passwd` : 

```bash
root:x:0:0:root:/root:/bin/bash
smmsp:x:123:132:Mail Submission Program,,,:/var/lib/sendmail:/bin/false
nvidia-persistenced:x:121:130:NVIDIA Persistence Daemon,,,:/:/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
```

`login:password:UID:GID:gecos:home:shell`

Что они означают :
1. **login** - Логин пользователя или регистрационное имя.
    - Уникальное имя которое пользователь вводит при входе в систему.
    - Логин связан с UID пользователя.
    - Переименование пользователя никак не влияет на его права доступа.
    - Имя должно состоять не более чем из 32 символов. 
    - В некоторых старых версиях UNIX существует ограничение длины логина до 8 символов.
    - Пример : test,root
2. **password** - Хеш Пароля.
    - Ранее в этом поле хранился хеш пароля и использовался для входа в систему, в современных дистибутивах поле не используется.
    - В современных дистибутивах поле содержит символ-заполнитель.
    - Из-за соображений безопасности пароли были перенесеныв фаил `/etc/shadow`.
    - Пользователь может быть создан и без пароля (но не рекомендуется, за исключением служебных ученых записей).
    - Пример : x
3. **UID** - Идентификатор пользователя
    - Максимальное значение приблизительно равно 2 <sup>32</sup> (4294967296).
    - Возможно наличие несколько пользователей с одним и тем же UID, что позволяет иметь сразу несколько имен для входа.
    - Допустимые значения UID зависят от системы, в общем случае от 0 до 65535.
    - Суперпользователь всегда имеет идентификатор 0.
    - Пользователю nobody обычно присваивается идентификатор 65534
    - Диапазон UID от 1 до 999 резервируются под системные нужды и зависит от дистрибутива.
    - Пример : 0
4. **GID** - Идентификатор основной группы пользователя
    - По умолчанию, в ОС Linux для каждого нового пользователя создается новая группа с таким же регистрационным именем.
    - Пользователь может принадлежать к нескольким группам.
    - Группы к которым принадлежит пользователь указываются в файле `/etc/groups`.
    - Пример : 0
5. **gecos** - Комментарии к учетной записи, содержит текст описывающий пользователя.
    - Поле не имеет четко построенного синтаксиса.
    - Этот текст может выводится различными программами например `finger`.
    - Поля могут указываться через запятую в следующем порядке :
        1. полное имя.
        2. номер офиса и здания.
        3. рабочий телефон.
        4. домашний телефон.
    - Пример : Edward Chernenko,Marx Street 10,4554391,5454221
6. **home** - Домашний каталог пользователя, куда пользователь попадает после входа в систему.  
    - Путь становится значением переменной среды `HOME`.
    - Пример : /root 
7. **shell** - Начальный командный интерпретатор, которому передается управление после входа пользователя в систему.
    - Содержимое поля становится значением переменной среды `SHELL`.
    - Здесь может быть указана абсолютно любая программа.
    - Если поле пустое выбирается значение по умолчанию `/bin/sh`
    - Для системных пользователей в качестве командного интерпретатора могут быть установлены `/bin/bash` , `/dev/null`, `/bin/false`, `/usr/sbin/nologin`
    - Пример : `/bin/bash` , `/dev/null`

>> Большинство платформ поддерживают как минимум 7 полей. Существуют системы где полей может быть 5 и 10

![passwd](/archive/images/articles/unix/unix-user/passwd.png "passwd")

Командой `vipw` возможно отредактироовать фаил `/etc/passwd`


## Теневые пароли /etc/shadow
Эксперименты
Создать пользователя больше 32 символов
Создать 

usermod -u 5000000000 test
usermod: invalid user ID '5000000000'

Типы пользователей и типы учетных записей


Debian 
Centos 
Alpine

https://habr.com/ru/post/110012/
https://sonikelf.ru/polzovatel-root-i-drugie-polzovateli-gruppy-v-linux/#vsyakoe-raznoe-o-mnogopolzovatelskoj-linux-i-administratorskom-akkaunte-root

https://interface31.ru/tech_it/2019/12/linux-nachinayushhim-chast-6-upravlenie-pol-zovatelyami-i-gruppami.html